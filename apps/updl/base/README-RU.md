# UPDL (Universal Platform Definition Language)

Система определения узлов для создания универсальных 3D/AR/VR‑пространств в Flowise.

## Описание

UPDL предоставляет набор специализированных узлов редактора Flowise, позволяющий описывать 3D‑пространства на высоком уровне абстракции и затем экспортировать их в различные технологии через систему публикации.

## Архитектура

UPDL является чистым модулем определения узлов и интегрируется с Flowise через механизм NodesPool.

## Структура

```
src/
  ├── assets/          # Статические ресурсы (иконки)
  ├── i18n/            # Файлы локализации
  ├── interfaces/      # Интерфейсы TypeScript
  ├── nodes/           # Определения узлов UPDL
  └── index.ts         # Точка входа
```

## Загрузка узлов

- Узлы подгружаются Flowise из каталога `dist/nodes`
- Каждый узел наследует `BaseUPDLNode` и реализует интерфейс Flowise

## Поддерживаемые типы узлов

- **Space Node**: корневой контейнер пространства и глобальные параметры
- **Object Node**: 3D‑объекты (куб, сфера и т.п.)
- **Data Node**: вопросы и ответы для квизов
- **Camera Node**: настройка точки обзора
- **Light Node**: источники света

Data‑узлы используются при создании квизов. Узел вопроса может иметь несколько узлов‑ответов. Ответы могут помечаться флагом `isCorrect`, содержать `pointsValue` и ссылаться на узлы Object для отображения модели при выборе.

## Обработка пространства

Сервер Flowise обрабатывает связки узлов через `utilBuildUPDLflow` и передаёт данные в систему публикации, где пространство экспортируется, например, в AR.js.

## Интеграция

- Редактор Flowise — отображение пользовательских узлов
- Система публикации (publish‑frt/publish‑srv) — экспорт пространств
- Сервер Flowise — обработка данных графа

## Фокус модуля

Модуль содержит только определения узлов. Логика экспорта и генерация пространств находятся в приложениях публикации.

---

_Universo Platformo | Модуль UPDL_
