# Проверка консистентности i18n‑документации

Эта страница описывает, как в репозитории проверяется соответствие английской и русской документации, и как запускать проверку локально и в CI.

## Обзор

В репозитории есть небольшой Node‑скрипт, который проверяет, что парные файлы EN/RU остаются структурно идентичными:

- Совпадает количество строк
- Совпадает число заголовков (`#`)
- Совпадает число ограждений для кода (```)
- Совпадает число пунктов списка (-)

Расположение скрипта:

```
tools/docs/check-i18n-docs.mjs
```

## Локальный запуск

Запустите проверку через PNPM:

```
pnpm docs:i18n:check
```

По умолчанию скрипт работает в области Resources. Явно задать область можно через переменную окружения:

```
I18N_SCOPE=resources pnpm docs:i18n:check
I18N_SCOPE=all        pnpm docs:i18n:check
```

Области:

- `resources` — только пары, относящиеся к приложениям Resources (`apps/resources-frt`, `apps/resources-srv`) и их документации (`docs/en|ru/applications/resources/README.md`)
- `all` — сканировать весь репозиторий (включать после полной синхронизации остальной документации)

## CI‑воркфлоу

GitHub Actions запускает проверку на pull request и push, затрагивающих документацию Resources:

```
.github/workflows/docs-i18n-check.yml
```

Джоб использует Node 20, PNPM 9, ставит зависимости и выполняет:

```
I18N_SCOPE=resources pnpm docs:i18n:check
```

## Вывод при ошибке

При несовпадении скрипт выводит пути EN/RU файлов и все отличия (число строк, заголовков, блоков кода, пунктов списка) и завершает работу с кодом 1. Приведите RU‑файл к структуре EN‑файла (или наоборот) перед слиянием.

## Расширение на весь репозиторий

Когда широкая документация будет синхронизирована, замените шаг воркфлоу на:

```
I18N_SCOPE=all pnpm docs:i18n:check
```

## Необязательный pre‑commit

Можно добавить Husky pre‑commit, запускающий проверку только при изменении пар README. Учитывайте, что это строгий шаг и он будет блокировать коммиты до выравнивания пар.

